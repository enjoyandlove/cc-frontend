<div 
  class="margin-bottom"
  [ngSwitch]="isFormReady">

  <cp-spinner *ngSwitchCase="false"></cp-spinner>

  <ng-container *ngSwitchCase="true">
    <form
      [formGroup]="form"
      *ngSwitchCase="true">
      <div class="row">
        <div class="col">
          <div class="cp-card">
              <div class="row">
              <div class="col-12">
                  <p class="title">{{ 'events_event_banner' | cpI18n }}</p>
                  <div class="margin-top">
                  <cp-image-upload
                      (uploaded)="onUploadedImage($event)"
                      [defaultImage]="form.controls['poster_url'].value"
                      [required]="formMissingFields && form.controls['poster_url'].hasError('required')">
                  </cp-image-upload>
                  </div>
              </div>
              </div>
      
              <div class="row event-details">
              <div class="col-12">
                  <p class="title">{{ 'events_event_details' | cpI18n }}</p>
                  <div class="form-group margin-top">
                  <label>{{ 'events_event_name' | cpI18n }}</label>
                  <input
                      type="text"
                      class="form-control"
                      formControlName="title"
                      [class.error]="formMissingFields && form.controls['title'].hasError('required')">
                  </div>
      
                  <div class="row form-group" *ngIf="!isClub && !isService && !isOrientation">
                  <div class="col-12">
                      <label>{{ 'select_host' | cpI18n }}</label>
                      <cp-dropdown
                      [items]="stores"
                      [selectedItem]="originalHost"
                      (selected)="onSelectedHost($event)"
                      [isRequiredError]="formMissingFields && form.controls['store_id'].hasError('required')">
                      </cp-dropdown>
                  </div>
                  </div>
      
                  <div class="row form-group">
                  <div class="col-6">
                      <label>{{ 'start_date' | cpI18n }}</label>
                      <cp-datepicker
                      [options]="startdatePickerOpts"
                      [error]="formMissingFields && form.controls['start'].hasError('required')">
                      </cp-datepicker>
                  </div>
                  <div class="col-6">
                      <label>{{ 'end_date' | cpI18n }}</label>
                      <cp-datepicker
                      [options]="enddatePickerOpts"
                      [error]="formMissingFields && form.controls['end'].hasError('required')">
                      </cp-datepicker>
                  </div>
                  </div>
      
                  <div class="row form-group" *ngIf="isOrientation">
                  <div class="col-12">
                      <cp-checkbox
                      class="checkbox"
                      (toggle)="onAllDayToggle($event)"
                      [isChecked]="form.controls['is_all_day'].value">
                      </cp-checkbox>
                      <label>{{ 'all_day' | cpI18n }}</label>
                  </div>
                  </div>
      
                  <div class="form-group">
                  <label>{{ 'events_event_description' | cpI18n }}</label>
                  <textarea formControlName="description"></textarea>
                  </div>

                  <div class="row form-group">
                      <div class="col-12">
                          <cp-checkbox
                            class="checkbox"
                            [isChecked]="canViewLocation"
                            (toggle)="onLocationToggle($event)">
                          </cp-checkbox>
                          <label>{{ 't_shared_label_location_toggle' | cpI18n }}</label>
                      </div>
                  </div>

                  <div *ngIf="canViewLocation">
                      <div class="row">
                      <div class="col-12">
                          <label>{{ 'location' | cpI18n }}</label>
                          <div class="row form-group">
                          <div class="col-12">
                              <cp-place-autocomplete
                              [newAddress]="newAddress"
                              (backToDefault)="onResetMap()"
                              (placeChange)="onPlaceChange($event)"
                              [defaultValue]="form.controls.address.value">
                              </cp-place-autocomplete>
                          </div>
                          </div>
                          <div class="row form-group">
                          <div class="col-6">
                              <label>{{ 'building' | cpI18n }}</label>
                              <input
                              type="text"
                              class="form-control"
                              formControlName="location">
                          </div>

                          <div class="col-6">
                              <label>{{ 'room' | cpI18n }}</label>
                              <input
                              type="text"
                              class="form-control"
                              formControlName="room_data">
                          </div>
                          </div>
                      </div>
                      </div>

                      <div class="row">
                      <div class="col-12">
                          <div class="maps">
                          <cp-maps
                              [center]="mapCenter"
                              [drawMarker]="drawMarker"
                              (mapSelection)="onMapSelection($event)">
                          </cp-maps>
                          </div>
                      </div>
                      </div>
                  </div>
              </div>
              </div>
          </div>
          </div>
      
          <div class="col">
          <div class="cp-card">
              <div class="row">
              <div class="col-12">
                  <p class="title">{{ 'assessment' | cpI18n }}</p>
                  <span class="float-right">
                  <cp-switch
                  (toggle)="toggleEventAttendance($event)"
                  [isChecked]="form.controls.event_attendance.value === attendanceEnabled">
                  </cp-switch>
              </span>
              </div>
              </div>
  
              <div *ngIf="form.controls.event_attendance.value === attendanceEnabled">
              <div class="row margin-top">
                  <div class="col-6">
                  <div class="form-group">
                      <label>{{ 'events_event_manager' | cpI18n }}
                      <cp-tooltip
                          [toolTipContent]="eventManagerToolTip">
                      </cp-tooltip>
                      </label>
                      <cp-dropdown
                      [items]="managers"
                      [selectedItem]="selectedManager"
                      (selected)="onSelectedManager($event)"
                      [isRequiredError]="formMissingFields && form.controls['event_manager_id'].hasError('required')">
                      </cp-dropdown>
                  </div>
                  </div>
                  <div class="col-6">
                  <div class="form-group">
                      <label>{{ 'events_attendance_manager_full' | cpI18n }}
                      <cp-tooltip
                          [toolTipContent]="attendanceManagerToolTip">
                      </cp-tooltip>
                      </label>
                      <input
                      type="text"
                      class="form-control"
                      formControlName="attendance_manager_email">
                  </div>
                  </div>
              </div>
  
              <div class="row form-group">
                  <div class="col-6">
                  <label>{{ 'student_feedback' | cpI18n }}
                      <cp-tooltip
                      [toolTipContent]="studentFeedbackToolTip">
                      </cp-tooltip>
                  </label>
                  <cp-dropdown
                      [items]="booleanOptions"
                      [selectedItem]="originalAttnFeedback"
                      (selected)="onEventFeedbackChange($event)"
                      [isRequiredError]="formMissingFields && form.controls['event_feedback'].hasError('required')">
                  </cp-dropdown>
                  </div>
              </div>
  
              <div class="row form-group" *ngIf="form.controls['event_feedback'].value === eventFeedbackEnabled">
                  <div class="col-12">
                  <label>{{ 'events_default_question' | cpI18n }}</label>
                  <input
                      type="text"
                      class="form-control"
                      formControlName="custom_basic_feedback_label">
                  </div>
              </div>
              </div>
          </div>
          </div>
      
          <div class="footer">
          <div class="cp-wrapper cp-wrapper--outer">
              <div class="col-12">
              <div class="row">
                  <div class="col-12">
                  <div class="text-right">
                      <label class="error" *ngIf="formMissingFields">
                          <span>&#x26A0;</span>
                          {{ isDateError ? dateErrorMessage : cpI18n.translate('error_fill_out_marked_fields') }}
                      </label>
                      <label class="error" *ngIf="serverError;">
                          <span>&#x26A0;</span> {{ cpI18n.translate('something_went_wrong') }}
                      </label>
                      <a [routerLink]="['../']"
                      class="cpbtn cpbtn--cancel">
                      {{ 'cancel' | cpI18n }}
                      </a>
                      <cp-button
                      [props]="buttonData"
                      (buttonClick)="onSubmit(form.value)">
                      </cp-button>
                  </div>
                  </div>
              </div>
              </div>
          </div>
          </div>
      </div>
    </form>
  </ng-container>
</div>