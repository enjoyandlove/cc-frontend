<div class="row">
  <div class="col-xs-12">
    <cp-students-top-bar (filter)="onFilter($event)"></cp-students-top-bar>
  </div>
</div>

<ng-container [ngSwitch]="loading">
  <cp-spinner *ngSwitchCase="true"></cp-spinner>

  <div *ngSwitchCase="false">
    <cp-no-content
      class="no-content"
      *ngIf="!students.length"
      noContentText="No students found...">
    </cp-no-content>

    <div *ngIf="students.length">
      <ul class="students cp-form">
        <li class="cp-form__header col-xs-12">
          <div class="row">
            <span class="col-xs-3" i18n>Name</span>
            <span class="col-xs-3" i18n>Engagement (Last 7 Days)</span>
            <span class="col-xs-3" i18n>Last Engagement</span>
            <span class="col-xs-3"></span>
          </div>
        </li>

        <li
          class="cp-form__item col-xs-12"
          *ngFor="let student of students">
          <div class="row">
            <span class="col-xs-3 text-truncate students__thumbnail">
              <div class="row">
                <div class="col-xs-3 no-right-padding">
                  <img src="https://unsplash.it/40/40" class="img-rounded">
                </div>
                <div class="col-xs-9 no-left-padding">
                  <a [routerLink]="[student.id]">
                    <strong>{{ student.first_name }} {{ student.last_name }}</strong>
                  </a>
                </div>
              </div>
            </span>

            <span class="col-xs-3">
              {{ student.last_seven_days.events }} Events and {{ student.last_seven_days.services }} Services
            </span>

            <span class="col-xs-3">
              {{ student.last_engagement | cpDatePipe:dateFormat }}
            </span>

            <span class="col-xs-3 text-right">
              <button
                type="button"
                class="cpbtn cpbtn--link" i18n
                (click)="messageStudent(student)">
                Message Student
              </button>
            </span>
          </div>
        </li>
      </ul>

      <cp-pagination
        [pageNext]="pageNext"
        [pagePrev]="pagePrev"
        [pageNumber]="pageNumber"
        (next)="onPaginationNext()"
        (previous)="onPaginationPrevious()">
      </cp-pagination>
    </div>
  </div>
</ng-container>

<cp-modal
  *ngIf="isStudentComposeModal"
  modalId="studentsComposeModal">
  <cp-students-compose
    [props]="messageData"
    (success)="onFlashMessage()"
    (teardown)="onComposeTeardown()">
  </cp-students-compose>
</cp-modal>