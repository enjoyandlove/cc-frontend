<ng-container [ngSwitch]="loading || state.working">
  <cp-spinner *ngSwitchCase="true"></cp-spinner>
  <ng-container *ngSwitchCase="false">
    <div class="cp-card">
      <div 
        class="row" 
        *ngFor="let guide of guides; let first = first; let last = last; let i = index">
        <div class="col-12">
          <cp-personas-section 
            [last]="last"
            [guide]="guide"
            [first]="first"
            [addSection]="!first"
            (addTile)="onAddTileToGuideClick()"
            (deleted)="onDeletedSection($event)"
            (swap)="onSwapSection($event, guide)"
            [previousSection]="getSectionByIndex(i - 1)"
            (created)="onAddSectionBefore($event, guide.id)">
          </cp-personas-section>
        </div>
      </div>
    </div>

    <cp-modal modalId="tilesCreate">
      <cp-personas-tile-create></cp-personas-tile-create>
    </cp-modal>
  </ng-container>
</ng-container>