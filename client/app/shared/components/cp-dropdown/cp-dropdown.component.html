<div class="cpbtn-group cp-dropdown">
  <button
    type="button"
    data-toggle="dropdown"
    [class.cpbtn--cancel--error]="isRequiredError"
    class="cpbtn cpbtn--cancel cp-dropdown__button text-truncate">
    {{ selectedItem ? selectedItem.label : items[0].label }}
    <i class="material-icons">keyboard_arrow_down</i>
  </button>
  <ul class="cp-dropdown__list dropdown-menu" *ngIf="items.length > 1">
    <li
      *ngIf="items.length > MIN_RESULTS_FOR_SEARCH"
      class="cp-dropdown__list__item cp-dropdown__list__item--search no-hover">
      <cp-searchbox
        [fixed]="searchFixed"
        (query)="onSearch($event)"
        (searching)="isSearching = $event">
      </cp-searchbox>
    </li>

    <li *ngIf="isSearching" class="cp-dropdown__list__item cp-dropdown__list__item--spinner">
      <cp-spinner theme="small"></cp-spinner>
    </li>

    <ng-container *ngIf="!isSearching">
      <li
        (click)="onClick(item)"
        *ngFor="let item of items | cpFilterPipe: { query: query, filterBy: 'label' }"
        class="cp-dropdown__list__item">
        <span [class.isLabel]="item.heading">{{ item.label }}</span>
      </li>
    </ng-container>
  </ul>
</div>
