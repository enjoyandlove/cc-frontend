<div class="row">
  <div class="col-xs-12 header">
    <p i18n>
      To import events from Facebook pages, input the link to the page's
      event list eg. https://www.facebook.com/oohlala/events
    </p>
  </div>
</div>

<div class="row">
  <div class="col-xs-12">
    <div class="cp-card">
      <form [formGroup]="form">
        <div class="form-group" formArrayName="links">
          <div
            class="row link-group"
            *ngFor="let link of form.controls.links.controls; let i = index">
            <div [formGroupName]="i">
              <div class="row" >
                <div class="col-xs-3">
                  <label i18n>Facebook Event Link</label>
                  <input
                    type="text"
                    class="form-control"
                    formControlName="link"
                    placeholder="https://www.facebook.com/oohlala/events">
                </div>
                <div class="col-xs-2" *ngIf="!link.isOpen">
                  <label>&nbsp;</label>
                  <button
                    type="button"
                    (click)="addLinkControl(i)"
                    (click)="link.isOpen = true"
                    [disabled]="!link.controls['link'].valid"
                    class="cpbtn cpbtn--secondary text-right" i18n>
                    Add Link
                  </button>
                </div>
                <div *ngIf="link.isOpen">
                  <div class="col-xs-2">
                    <label i18n>Host</label>
                    <select formControlName="store_id">
                      <option value="">Host Name</option>
                    </select>
                  </div>
                  <div class="col-xs-1">
                    <label i18n>Attendance</label>
                    <cp-switch
                      [id]="i + 1"
                      class="switch"
                      (toggle)="toggleIsAttendance(i, $event)">
                    </cp-switch>
                  </div>
                  <div class="col-xs-1">
                    <label i18n>Feedback</label>
                    <cp-switch
                      [id]="'feed' + i + 1"
                      class="switch"
                      (toggle)="toogleIsFeedback(i, $event)">
                    </cp-switch>
                  </div>
                  <div *ngIf="link.controls['attendance'].value">
                    <div class="col-xs-2">
                      <label i18n>Event Manager</label>
                      <select formControlName="event_manager">
                        <option value="">John Smith</option>
                      </select>
                    </div>
                    <div class="col-xs-2">
                      <label i18n>Attendance Manager</label>
                      <input
                        type="email"
                        class="form-control"
                        placeholder="email@example.com"
                        formControlName="attendance_manager">
                    </div>
                  </div>
                  <div
                    (click)="onDeleteControl(i)"
                    class="delete hover"
                    [ngClass]="[link.controls['attendance'].value
                              ? 'col-xs-1'
                              : 'col-xs-1 col-xs-offset-4']">
                    &times;
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="row" *ngIf="form.controls.links.length > 1">
  <div class="col-xs-12">
    <button
      i18n
      type="button"
      (click)="doSubmit()"
      class="cpbtn cpbtn--primary submit pull-right">
      <span>&#10227;</span>Sync Facebook Events
    </button>
  </div>
</div>


